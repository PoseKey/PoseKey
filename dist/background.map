{"version":3,"sources":["background.js"],"names":["console","log","is","lastTab","lastWindow","chrome","browserAction","onClicked","addListener","buttonClicked","tabs","onUpdated","onLoad","onCreated","onActivated","active","windows","onFocusChanged","window","tab","msg","data","setIcon","path","query","i","length","sendMessage","id","msg2","tabId","windowId","currentWindow","current","highlight"],"mappings":"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","file":"background.map","sourceRoot":"..","sourcesContent":["console.log('background running');\r\n\r\nlet is = true;\r\nlet lastTab;\r\nlet lastWindow;\r\nchrome.browserAction.onClicked.addListener(buttonClicked);\r\nchrome.tabs.onUpdated.addListener(onLoad);\r\nchrome.tabs.onCreated.addListener(onLoad);\r\nchrome.tabs.onActivated.addListener(active);    //active는 하나밖에 없음\r\nchrome.windows.onFocusChanged.addListener(window);\r\n// chrome.tabs.onHighlighted.addListener(highlight);\r\n\r\nfunction buttonClicked(tab) {\r\n    console.log(\"button clicked!\");\r\n    console.log(tab);\r\n    let msg = {\r\n        data: \"ON\"\r\n    };\r\n    if(is===true){\r\n        msg.data = \"OFF\";\r\n        is = false;\r\n        chrome.browserAction.setIcon({path: \"likeR.png\"});\r\n        /* 모든 탭에 OFF하라고 보냄*/\r\n        chrome.tabs.query({}, function(tabs) {\r\n            for (let i=0; i<tabs.length; i++) {\r\n                chrome.tabs.sendMessage(tabs[i].id, msg);\r\n            }\r\n        });\r\n    }\r\n    else {\r\n        is = true;\r\n        chrome.browserAction.setIcon({path: \"likeG.png\"});\r\n        chrome.tabs.sendMessage(tab.id, msg);   // 현재 탭에만 ON하라고 보냄\r\n    }\r\n}\r\n\r\nfunction onLoad(id){\r\n    console.log(\"onLoad!\");\r\n    // console.log(id);\r\n    let msg \r\n    if (is === true){\r\n        msg = {\r\n            data: \"ON\"\r\n        };\r\n    }\r\n    else {\r\n        msg = {\r\n            data: \"OFF\"\r\n        };\r\n    }\r\n    chrome.tabs.sendMessage(id, msg);\r\n}\r\n\r\nfunction active(tab){\r\n    // console.log(\"tab changed!\");\r\n    // console.log(tab.tabId);\r\n    let msg={\r\n        data: \"ON\"\r\n    }\r\n    let msg2={\r\n        data: \"OFF\"\r\n    }\r\n    if (is === false){\r\n        msg.data = \"OFF\";\r\n    }\r\n    chrome.tabs.query({}, function(tabs) {\r\n        for (let i=0; i<tabs.length; i++) {\r\n            chrome.tabs.sendMessage(tabs[i].id, msg2);\r\n        }\r\n    });\r\n    chrome.tabs.sendMessage(tab.tabId, msg);\r\n    // if(lastTab){\r\n    //     chrome.tabs.sendMessage(lastTab, msg2);\r\n    // }\r\n    // lastTab = tab.tabId;\r\n}\r\n\r\nfunction window(windowId){\r\n    let msg={\r\n        data: \"ON\"\r\n    }\r\n    let msg2={\r\n        data: \"OFF\"\r\n    }\r\n    if (is === false){\r\n        msg.data = \"OFF\";\r\n    }\r\n    chrome.tabs.query({}, function(tabs) {\r\n        for (let i=0; i<tabs.length; i++) {\r\n            chrome.tabs.sendMessage(tabs[i].id, msg2);\r\n        }\r\n    });\r\n\r\n    // console.log(\"window changed!\");\r\n    chrome.tabs.query({active:true,currentWindow: true},function(tabs){\r\n        var current = tabs[0].id;\r\n        // console.log(windowId + \", \" + current);\r\n        chrome.tabs.sendMessage(current, msg);\r\n        // chrome.tabs.sendMessage(lastTab, msg2);\r\n        lastTab = current;\r\n        // lastWindow=windowId;\r\n    });\r\n    // if(lastWindow!=windowId){\r\n    //     chrome.tabs.sendMessage(lastTab, msg2);\r\n    // }\r\n}\r\n\r\nfunction highlight(tab){\r\n    console.log(\"highlight!\");\r\n}"]}